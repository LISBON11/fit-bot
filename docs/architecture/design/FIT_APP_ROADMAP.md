# üó∫Ô∏è FitApp ‚Äî –î–æ—Ä–æ–∂–Ω–∞—è –∫–∞—Ä—Ç–∞ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

> **–ö–∞–∫ —á–∏—Ç–∞—Ç—å —ç—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç:**
>
> - üßë‚Äçüíº **–î–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞** ‚Äî –±–∏–∑–Ω–µ—Å-—Ü–µ–Ω–Ω–æ—Å—Ç—å, —á—Ç–æ –ø–æ–ª—É—á–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –º–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞
> - üßë‚Äçüíª **–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞** ‚Äî —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏, –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, acceptance criteria
> - ü§ñ **–ü—Ä–æ–º–ø—Ç –¥–ª—è AI-–∞–≥–µ–Ω—Ç–∞** ‚Äî –≥–æ—Ç–æ–≤—ã–π –ø—Ä–æ–º–ø—Ç, –∫–æ–ø–∏—Ä—É–π –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–π –∞–≥–µ–Ω—Ç—É

**–ö–æ–Ω—Ç–µ–∫—Å—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –¥–∏–∑–∞–π–Ω–∞:** [FIT_APP_SYSTEM_DESIGN.md](./FIT_APP_SYSTEM_DESIGN.md)
**–ë–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:** [FIT_APP_BUSINESS_REQUIREMENTS.md](../../../FIT_APP_BUSINESS_REQUIREMENTS.md)
**–¢–µ–∫—É—â–∏–π ROADMAP –±–æ—Ç–∞:** [ROADMAP.md](../../../ROADMAP.md) (–≠—Ç–∞–ø—ã 1‚Äì6 –≤—ã–ø–æ–ª–Ω–µ–Ω—ã, –≠—Ç–∞–ø 7 ‚Äî –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω)

> [!IMPORTANT]
> **–°—Ç–∞—Ä—Ç–æ–≤–∞—è —Ç–æ—á–∫–∞**: –≠—Ç–∞–ø 7 –∏–∑ `ROADMAP.md` (REST API, JWT, Analytics) **–Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω**.
> –§–∞–∑–∞ 0 –¥–∞–Ω–Ω–æ–≥–æ roadmap = –≠—Ç–∞–ø 7 –∏–∑ ROADMAP.md –±–æ—Ç–∞. –ë–µ–∑ –Ω–µ—ë –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ.

---

## –û–±–∑–æ—Ä —Ñ–∞–∑

| –§–∞–∑–∞  | –ù–∞–∑–≤–∞–Ω–∏–µ            | –ë–∏–∑–Ω–µ—Å-—Ä–µ–∑—É–ª—å—Ç–∞—Ç               | –ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–æ—Ü–µ–Ω–∫–∞) |
| ----- | ------------------- | ------------------------------ | -------------------------- |
| **0** | API-—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç       | –ë—ç–∫–µ–Ω–¥ –≥–æ—Ç–æ–≤ –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è    | 2‚Äì3 –Ω–µ–¥–µ–ª–∏                 |
| **1** | App MVP             | –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ App Store         | 6‚Äì8 –Ω–µ–¥–µ–ª—å                 |
| **2** | –ì–æ–ª–æ—Å + –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è | Hands-free —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏          | 4‚Äì6 –Ω–µ–¥–µ–ª—å                 |
| **3** | AI-—Ç—Ä–µ–Ω–µ—Ä           | –ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –∏ —Å–æ–ø–µ—Ä–Ω–∏—á–µ—Å—Ç–≤–æ | 8‚Äì12 –Ω–µ–¥–µ–ª—å                |
| **4** | –ê–Ω–∞–ª–∏–∑ —Ç–µ—Ö–Ω–∏–∫–∏      | –ö–∞–º–µ—Ä–∞ –∫–∞–∫ —Ç—Ä–µ–Ω–µ—Ä              | 12+ –Ω–µ–¥–µ–ª—å                 |

---

## –§–∞–∑–∞ 0: API-—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç (–≠—Ç–∞–ø 7 ROADMAP.md)

### 0.1 –ú–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ Fastify REST API

---

#### üßë‚Äçüíº –î–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç**: –ú—ã –ø–µ—Ä–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä—É–µ–º –∫–æ–¥ —Ç–∞–∫, —á—Ç–æ–±—ã –∏ –±–æ—Ç, –∏ –±—É–¥—É—â–µ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–ª–∏ —Å –æ–¥–Ω–æ–π –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ –æ–±—â–∏–π ¬´–±—ç–∫–µ–Ω–¥-—Å–µ—Ä–≤–µ—Ä¬ª. –≠—Ç–æ —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç ‚Äî –±–µ–∑ –Ω–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ–ª—å–∑—è –Ω–∞—á–∏–Ω–∞—Ç—å.

**–ß—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–≤–∏–¥–∏—Ç**: –ù–∏—á–µ–≥–æ. –ë–æ—Ç –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ –ø—Ä–µ–∂–¥–µ.

**–†–∏—Å–∫, –µ—Å–ª–∏ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å**: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ —Å–º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Äî –æ–Ω–∏ –±—É–¥—É—Ç –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –≤ –±–æ—Ç–µ.

**–ú–µ—Ç—Ä–∏–∫–∞ —É—Å–ø–µ—Ö–∞**: –ë–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π, –Ω–æ–≤—ã–π API-—Å–µ—Ä–≤–µ—Ä –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã.

---

#### üßë‚Äçüíª –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: –≠—Ç–∞–ø—ã 1‚Äì6 ROADMAP.md –≤—ã–ø–æ–ª–Ω–µ–Ω—ã.

**–ó–∞–¥–∞—á–∏**:

1. –ü–µ—Ä–µ–≤–µ—Å—Ç–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –≤ **pnpm workspaces** –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
   - `apps/bot` ‚Äî —Ç–µ–∫—É—â–∏–π –∫–æ–¥ –±–æ—Ç–∞ (–ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
   - `apps/api` ‚Äî –Ω–æ–≤—ã–π Fastify —Å–µ—Ä–≤–∏—Å
   - `packages/shared-types` ‚Äî TypeScript —Ç–∏–ø—ã –∏–∑ `src/nlu/nlu.types.ts`, `src/services/*.ts`
2. –°–æ–∑–¥–∞—Ç—å `apps/api` ‚Äî Fastify v5 —Å–µ—Ä–≤–µ—Ä:
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å: `fastify`, `@fastify/cors`, `@fastify/helmet`, `@fastify/swagger`, `@fastify/multipart`
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å pino-–ª–æ–≥–≥–µ—Ä (–æ–±—â–∏–π —Å –±–æ—Ç–æ–º)
   - –ü–æ–¥–∫–ª—é—á–∏—Ç—å –∫ —Ç–æ–π –∂–µ PostgreSQL (Supabase) –∏ Redis
3. –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Å–µ—Ä–≤–∏—Å—ã –∏–∑ `apps/bot/src/services/` –≤ `apps/api/src/services/` (–∏–ª–∏ `packages/shared-types` ‚Äî common code)
4. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å CRUD —Ä–æ—É—Ç—ã:
   - `GET/POST /api/v1/workouts`, `GET/PUT/DELETE /api/v1/workouts/:id`
   - `POST /api/v1/workouts/:id/approve`, `/cancel`
   - `GET/POST /api/v1/exercises`
   - `GET /api/v1/exercises/suggestions` (–¥–ª—è NLU –±–æ—Ç–∞)
5. –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å –±–æ—Ç: –∑–∞–º–µ–Ω–∏—Ç—å –ø—Ä—è–º—ã–µ –≤—ã–∑–æ–≤—ã `WorkoutService` –Ω–∞ HTTP-–≤—ã–∑–æ–≤—ã –∫ API (—á–µ—Ä–µ–∑ `axios` –∏–ª–∏ `fetch`)
6. –î–æ–±–∞–≤–∏—Ç—å HTTP-—Ä–æ—É—Ç—ã –¥–ª—è STT –∏ NLU: `POST /api/v1/stt/transcribe`, `POST /api/v1/nlu/parse`, `POST /api/v1/nlu/parse-delta`
7. –¢–µ—Å—Ç—ã: route handlers —Å –º–æ–∫-—Å–µ—Ä–≤–∏—Å–∞–º–∏ (jest + jest-mock-extended)
8. –û–±–Ω–æ–≤–∏—Ç—å `docker-compose.prod.yml`: –¥–æ–±–∞–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å `api`

**Acceptance criteria**:

- [ ] `pnpm lint && pnpm test` ‚Äî –ø—Ä–æ—Ö–æ–¥–∏—Ç –≤–æ –≤—Å–µ—Ö workspace
- [ ] `GET /api/v1/workouts` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ (—Å –≤–∞–ª–∏–¥–Ω—ã–º JWT)
- [ ] –ë–æ—Ç –ø–æ-–ø—Ä–µ–∂–Ω–µ–º—É —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ —Å–æ–∑–¥–∞—ë—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ (—á–µ—Ä–µ–∑ HTTP API)
- [ ] Swagger –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞ `/docs`

---

#### ü§ñ –ü—Ä–æ–º–ø—Ç –¥–ª—è AI-–∞–≥–µ–Ω—Ç–∞

```prompt
–†–µ–∞–ª–∏–∑—É–π –≠—Ç–∞–ø 7.1 –∏–∑ ROADMAP.md (REST API) –∏ –ø–µ—Ä–µ–≤–µ–¥–∏ –ø—Ä–æ–µ–∫—Ç –≤ –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.

–ö–æ–Ω—Ç–µ–∫—Å—Ç:
- –ü—Ä–æ–µ–∫—Ç: /Users/elizavetagolubenko/Projects/fit-tel-bot
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: docs/architecture/design/FIT_APP_SYSTEM_DESIGN.md (—Ä–∞–∑–¥–µ–ª 2, 3, 5)
- –≠—Ç–∞–ø—ã 1‚Äì6 ROADMAP.md –≤—ã–ø–æ–ª–Ω–µ–Ω—ã. –°–µ—Ä–≤–∏—Å—ã WorkoutService, ExerciseService, UserService, STT, NLU —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ src/services/ –∏ src/stt/, src/nlu/
- –ë–î: PostgreSQL (Supabase), Redis (–Ø–Ω–¥–µ–∫—Å –û–±–ª–∞–∫–æ) ‚Äî –∫–æ–Ω—Ñ–∏–≥ –≤ src/config/

–ó–∞–¥–∞—á–∏:
1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å pnpm workspaces –≤ –∫–æ—Ä–Ω–µ: apps/bot (—Ç–µ–∫—É—â–∏–π –∫–æ–¥), apps/api (–Ω–æ–≤—ã–π), packages/shared-types
2. –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ TypeScript-—Ç–∏–ø—ã (ParsedWorkout, Exercise, User, WorkoutService –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã) –≤ packages/shared-types/src/index.ts
3. –°–æ–∑–¥–∞—Ç—å apps/api:
   - npm init, tsconfig.json (extends ../../packages/shared-config/tsconfig.base.json)
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å: fastify@5, @fastify/cors, @fastify/helmet, @fastify/swagger, @fastify/multipart, pino
   - src/server.ts: Fastify instance —Å pino-–ª–æ–≥–≥–µ—Ä–æ–º
   - src/routes/workouts.routes.ts: GET /, POST /, GET /:id, PUT /:id, DELETE /:id, POST /:id/approve, POST /:id/cancel
   - src/routes/exercises.routes.ts: GET / (—Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏), POST /, GET /suggestions
   - src/routes/stt.routes.ts: POST /transcribe (multipart, –∞—É–¥–∏–æ ‚Üí —Ç–µ–∫—Å—Ç)
   - src/routes/nlu.routes.ts: POST /parse, POST /parse-delta, POST /parse-voice-command
   - –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å WorkoutService, ExerciseService –∏–∑ apps/bot (–∏–ª–∏ –≤—ã–Ω–µ—Å—Ç–∏ –≤ packages/shared-services)
4. –ê–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å apps/bot: –∑–∞–º–µ–Ω–∏—Ç—å –ø—Ä—è–º—ã–µ –≤—ã–∑–æ–≤—ã —Å–µ—Ä–≤–∏—Å–æ–≤ –Ω–∞ HTTP-–≤—ã–∑–æ–≤—ã –∫ apps/api (http://localhost:3001)
5. docker-compose.prod.yml: –¥–æ–±–∞–≤–∏—Ç—å —Å–µ—Ä–≤–∏—Å api (–ø–æ—Ä—Ç 3001)
6. –¢–µ—Å—Ç—ã –∫ –∫–∞–∂–¥–æ–º—É route handler (jest + jest-mock-extended, –º–æ–∫–∏—Ä—É–µ–º —Å–µ—Ä–≤–∏—Å—ã)
7. TSDoc –Ω–∞ —Ä—É—Å—Å–∫–æ–º –∫ –ø—É–±–ª–∏—á–Ω—ã–º –º–µ—Ç–æ–¥–∞–º

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
- –ù–ï —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å JWT ‚Äî —ç—Ç–æ —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥ (0.2)
- –í—Ä–µ–º–µ–Ω–Ω–æ –≤—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–¥–æ–±–∞–≤–∏–º middleware –≤ 0.2)
- –ë–æ—Ç –¥–æ–ª–∂–µ–Ω –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Ä–∞–±–æ—Ç–∞—Ç—å –∏–¥–µ–Ω—Ç–∏—á–Ω–æ

Acceptance criteria:
- [ ] pnpm lint && pnpm test ‚Äî –ø—Ä–æ—Ö–æ–¥–∏—Ç –≤ apps/bot –∏ apps/api
- [ ] GET /api/v1/workouts ‚Äî –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 200 (–±–µ–∑ auth –ø–æ–∫–∞)
- [ ] POST /api/v1/stt/transcribe ‚Äî –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∞—É–¥–∏–æ, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—Å—Ç
- [ ] Swagger –Ω–∞ /docs –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ —Ä–æ—É—Ç—ã
- [ ] –ë–æ—Ç —Å–æ–∑–¥–∞—ë—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ —á–µ—Ä–µ–∑ HTTP API, –∞ –Ω–µ –Ω–∞–ø—Ä—è–º—É—é
```

---

### 0.2 JWT-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

---

#### üßë‚Äçüíº –î–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç**: –î–æ–±–∞–≤–ª—è–µ–º —Å–∏—Å—Ç–µ–º—É ¬´–∫–ª—é—á–µ–π –¥–æ—Å—Ç—É–ø–∞¬ª –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ö–∞–∂–¥—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç —Ç–æ–∫–µ–Ω –ø—Ä–∏ –≤—Ö–æ–¥–µ ‚Äî –æ–Ω –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç –ª–∏—á–Ω–æ—Å—Ç—å –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ. –ë–µ–∑ —ç—Ç–æ–≥–æ –ª—é–±–æ–π –º–æ–≥ –±—ã –ø–æ–ª—É—á–∏—Ç—å —á—É–∂–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏.

**–ß—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–≤–∏–¥–∏—Ç –≤ –±–æ—Ç–µ**: –ù–∏—á–µ–≥–æ ‚Äî –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –ø—Ä–µ–∂–¥–µ.

**–ú–µ—Ç—Ä–∏–∫–∞ —É—Å–ø–µ—Ö–∞**: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ email –∏ –≤—Ö–æ–¥ —á–µ—Ä–µ–∑ Telegram —Ä–∞–±–æ—Ç–∞—é—Ç, —Ç–æ–∫–µ–Ω—ã –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤—ã–¥–∞—é—Ç—Å—è –∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è.

---

#### üßë‚Äçüíª –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: –®–∞–≥ 0.1 –≤—ã–ø–æ–ª–Ω–µ–Ω.

**–ó–∞–¥–∞—á–∏**:

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å: `jsonwebtoken`, `bcrypt`, `@types/jsonwebtoken`, `@types/bcrypt`
2. `src/services/jwt.service.ts`: –≥–µ–Ω–µ—Ä–∞—Ü–∏—è RS256 access (15 –º–∏–Ω) –∏ refresh (30 –¥–Ω–µ–π) —Ç–æ–∫–µ–Ω–æ–≤, –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è
3. `src/routes/auth.routes.ts`:
   - `POST /auth/register` ‚Äî email + password ‚Üí hash ‚Üí create User + AuthProvider
   - `POST /auth/login` ‚Äî email + password ‚Üí JWT –ø–∞—Ä–∞
   - `POST /auth/refresh` ‚Äî refresh token ‚Üí –Ω–æ–≤—ã–π access token
   - `POST /auth/oauth/telegram` ‚Äî Telegram Login Widget hash verification ‚Üí JWT –ø–∞—Ä–∞
   - `POST /auth/link/generate-code` ‚Äî –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç 6-—Å–∏–º–≤–æ–ª—å–Ω—ã–π –∫–æ–¥, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ Redis (TTL 600 —Å–µ–∫)
   - `DELETE /auth/logout` ‚Äî —É–¥–∞–ª–∏—Ç—å refresh token –∏–∑ Redis
4. `src/middleware/jwtMiddleware.ts` ‚Äî Fastify preHandler: –ø—Ä–æ–≤–µ—Ä–∫–∞ `Authorization: Bearer`, `req.userId`
5. –ü–æ–¥–∫–ª—é—á–∏—Ç—å middleware –∫–æ –≤—Å–µ–º —Ä–æ—É—Ç–∞–º –∏–∑ 0.1 (–∫—Ä–æ–º–µ `/auth/*`)
6. –î–æ–±–∞–≤–∏—Ç—å –≤ `apps/bot`: –∫–æ–º–∞–Ω–¥–∞ `/link <code>` ‚Äî —á–∏—Ç–∞–µ—Ç –∫–æ–¥ –∏–∑ Redis ‚Üí –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç Telegram –∫ userId
7. –¢–µ—Å—Ç—ã: jwt.service (–≥–µ–Ω–µ—Ä–∞—Ü–∏—è, –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è, –∏—Å—Ç—ë–∫—à–∏–π), auth routes (–º–æ–∫ UserService)

**Acceptance criteria**:

- [ ] `POST /auth/register` + `POST /auth/login` ‚Üí –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
- [ ] `GET /api/v1/workouts` –±–µ–∑ —Ç–æ–∫–µ–Ω–∞ ‚Üí 401
- [ ] `POST /auth/oauth/telegram` –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç hash –ø–æ HMAC-SHA256(BOT_TOKEN)
- [ ] `/link ABC-123` –≤ –±–æ—Ç–µ –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç Telegram –∫ –∞–∫–∫–∞—É–Ω—Ç—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

#### ü§ñ –ü—Ä–æ–º–ø—Ç –¥–ª—è AI-–∞–≥–µ–Ω—Ç–∞

```prompt
–†–µ–∞–ª–∏–∑—É–π –≠—Ç–∞–ø 7.2 –∏–∑ ROADMAP.md (JWT-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è) –¥–ª—è FitApp API.

–ö–æ–Ω—Ç–µ–∫—Å—Ç:
- –ü—Ä–æ–µ–∫—Ç: /Users/elizavetagolubenko/Projects/fit-tel-bot (–º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø–æ—Å–ª–µ —à–∞–≥–∞ 0.1)
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: docs/architecture/design/FIT_APP_SYSTEM_DESIGN.md (—Ä–∞–∑–¥–µ–ª 6 ¬´–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è¬ª)
- apps/api —É–∂–µ —Å–æ–∑–¥–∞–Ω (—à–∞–≥ 0.1), JWT –µ—â—ë –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω

–ó–∞–¥–∞—á–∏ –≤ apps/api:
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å jsonwebtoken, bcrypt, @types/jsonwebtoken, @types/bcrypt
2. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å RS256 –∫–ª—é—á–µ–≤—É—é –ø–∞—Ä—É (–¥–æ–±–∞–≤–∏—Ç—å —Å–∫—Ä–∏–ø—Ç scripts/generate-keys.ts)
3. JWT_PRIVATE_KEY, JWT_PUBLIC_KEY –¥–æ–±–∞–≤–∏—Ç—å –≤ Zod-—Å—Ö–µ–º—É –∫–æ–Ω—Ñ–∏–≥–∞ (apps/api/src/config/env.ts)
4. src/services/jwt.service.ts:
   - generateTokenPair(userId: string): {accessToken, refreshToken}
   - verifyAccessToken(token: string): {userId: string}
   - –°–æ—Ö—Ä–∞–Ω—è—Ç—å refresh token –≤ Redis —Å –∫–ª—é—á–æ–º refresh:{userId}:{tokenId} (TTL 30 –¥–Ω–µ–π)
5. src/routes/auth.routes.ts:
   - POST /api/v1/auth/register ‚Äî email + password ‚Üí bcrypt hash ‚Üí UserService.create ‚Üí JWT –ø–∞—Ä–∞
   - POST /api/v1/auth/login ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å hash ‚Üí JWT –ø–∞—Ä–∞
   - POST /api/v1/auth/refresh ‚Äî –¥–æ—Å—Ç–∞—Ç—å –∏–∑ Redis ‚Üí —Ä–æ—Ç–∞—Ü–∏—è (—Å—Ç–∞—Ä—ã–π —É–¥–∞–ª–∏—Ç—å, –Ω–æ–≤—ã–π —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å)
   - POST /api/v1/auth/oauth/telegram ‚Äî HMAC –ø—Ä–æ–≤–µ—Ä–∫–∞ hash ‚Üí UserService.getOrCreateByTelegram ‚Üí JWT –ø–∞—Ä–∞
   - POST /api/v1/auth/link/generate-code ‚Äî —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å {code ‚Üí userId} –≤ Redis (TTL 600s)
   - DELETE /api/v1/auth/logout ‚Äî —É–¥–∞–ª–∏—Ç—å refresh token –∏–∑ Redis
6. src/middleware/jwtMiddleware.ts ‚Äî Fastify preHandler: –ø–∞—Ä—Å–∏—Ç Bearer, verifyAccessToken ‚Üí req.userId
7. –ü–æ–¥–∫–ª—é—á–∏—Ç—å jwtMiddleware –∫–æ –≤—Å–µ–º —Ä–æ—É—Ç–∞–º (workouts, exercises, stt, nlu, users) —á–µ—Ä–µ–∑ fastify.addHook('preHandler')
8. –í apps/bot/src/bot/handlers/commandHandlers.ts –¥–æ–±–∞–≤–∏—Ç—å /link <code>:
   - –ß–∏—Ç–∞–µ—Ç Redis: GET linkcode:{code}
   - –ß–µ—Ä–µ–∑ HTTP POST /api/v1/auth/link/confirm {code, telegramId}
   - –û—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é: "‚úÖ Telegram –ø—Ä–∏–≤—è–∑–∞–Ω"
9. –¢–µ—Å—Ç—ã (apps/api/src/**/__tests__/):
   - jwt.service.test.ts: generateTokenPair, verifyAccessToken (–≤–∞–ª–∏–¥–Ω—ã–π, –∏—Å—Ç—ë–∫—à–∏–π, –Ω–µ–≤–∞–ª–∏–¥–Ω–∞—è –ø–æ–¥–ø–∏—Å—å)
   - auth.routes.test.ts: register, login, refresh, oauth/telegram (–º–æ–∫ UserService, –º–æ–∫ Redis)

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
- –•—Ä–∞–Ω–∏—Ç—å private/public –∫–ª—é—á–∏ –≤ .env (base64-encoded PEM), –ù–ï –≤ —Ñ–∞–π–ª–∞—Ö
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å auth_date –≤ Telegram OAuth (–Ω–µ —Å—Ç–∞—Ä–µ–µ 86400 —Å–µ–∫—É–Ω–¥)
- –¢–µ—Å—Ç –ù–ï –¥–æ–ª–∂–µ–Ω –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ —Ä–µ–∞–ª—å–Ω–æ–º—É Redis –∏–ª–∏ –ë–î

Acceptance criteria:
- [ ] pnpm lint && pnpm test ‚Äî –≤—Å–µ —Ç–µ—Å—Ç—ã –∑–µ–ª—ë–Ω—ã–µ
- [ ] POST /auth/register ‚Üí 201 + {accessToken, refreshToken}
- [ ] GET /workouts –±–µ–∑ —Ç–æ–∫–µ–Ω–∞ ‚Üí 401 Unauthorized
- [ ] GET /workouts —Å –≤–∞–ª–∏–¥–Ω—ã–º —Ç–æ–∫–µ–Ω–æ–º ‚Üí 200 + –¥–∞–Ω–Ω—ã–µ
- [ ] /link ABC-123 –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç Telegram-–∞–∫–∫–∞—É–Ω—Ç, –ø–æ–≤—Ç–æ—Ä–Ω—ã–π /link ‚Üí –æ—à–∏–±–∫–∞ ¬´–∫–æ–¥ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω¬ª
```

---

### 0.3 Analytics API

---

#### üßë‚Äçüíº –î–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç**: –î–æ–±–∞–≤–ª—è–µ–º ¬´—É–º–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É¬ª ‚Äî —Å–∏—Å—Ç–µ–º–∞ –Ω–∞—á–∏–Ω–∞–µ—Ç —Å—á–∏—Ç–∞—Ç—å –ª–∏—á–Ω—ã–µ —Ä–µ–∫–æ—Ä–¥—ã, –ø—Ä–æ–≥—Ä–µ—Å—Å –∏ —á–∞—Å—Ç–æ—Ç—É —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫. –≠—Ç–æ –æ—Å–Ω–æ–≤–∞ –¥–ª—è —ç–∫—Ä–∞–Ω–æ–≤ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏.

**–ß—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–≤–∏–¥–∏—Ç –≤ –±–æ—Ç–µ**: –ö–æ–º–∞–Ω–¥—ã `/stats` –∏ `/progress <—É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ>`.

**–ú–µ—Ç—Ä–∏–∫–∞ —É—Å–ø–µ—Ö–∞**: –ö–æ–º–∞–Ω–¥–∞ `/stats` –≤ –±–æ—Ç–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å–≤–æ–¥–∫—É –∑–∞ –º–µ—Å—è—Ü.

---

#### üßë‚Äçüíª –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: –®–∞–≥ 0.2 –≤—ã–ø–æ–ª–Ω–µ–Ω.

**–ó–∞–¥–∞—á–∏**:

1. –ú–∏–≥—Ä–∞—Ü–∏—è Prisma: –Ω–æ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã `personal_records`, `streaks`
2. `src/services/analytics.service.ts`:
   - `getExerciseProgress(userId, exerciseId, period)` ‚Üí `[{date, maxWeight, volume}]` (GROUP BY date, MAX/SUM —á–µ—Ä–µ–∑ Prisma `$queryRaw`)
   - `getMuscleGroupVolume(userId, period)` ‚Üí `[{muscleGroup, totalSets, totalVolume}]`
   - `getTrainingFrequency(userId, period)` ‚Üí `{totalWorkouts, avgPerWeek}`
   - `findPersonalRecords(userId)` ‚Üí –≤—Å–µ PR –∏–∑ `personal_records`
   - `detectAndSavePR(workoutId)` ‚Äî –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ approve, –∏—â–µ—Ç –Ω–æ–≤—ã–µ —Ä–µ–∫–æ—Ä–¥—ã, —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ `personal_records`
3. `src/routes/analytics.routes.ts`: GET `/progress/:exerciseId`, `/volume`, `/frequency`, `/personal-records`
4. –í WorkoutService hook: –ø–æ—Å–ª–µ `approveDraft` ‚Üí –≤—ã–∑–≤–∞—Ç—å `analyticsService.detectAndSavePR(workoutId)`
5. –í apps/bot: `src/bot/handlers/analyticsHandlers.ts` ‚Äî `/stats`, `/progress <—É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ>`
6. –¢–µ—Å—Ç—ã: analyticsService —Å fixture-–¥–∞–Ω–Ω—ã–º–∏ (–º–æ–∫ Prisma `$queryRaw`)

**Acceptance criteria**:

- [ ] `GET /api/v1/analytics/personal-records` ‚Üí —Å–ø–∏—Å–æ–∫ PR
- [ ] –ü–æ—Å–ª–µ approve —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ ‚Äî PR –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç—Å—è –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
- [ ] `/stats` –≤ –±–æ—Ç–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

---

#### ü§ñ –ü—Ä–æ–º–ø—Ç –¥–ª—è AI-–∞–≥–µ–Ω—Ç–∞

```prompt
–†–µ–∞–ª–∏–∑—É–π –≠—Ç–∞–ø 7.3 –∏–∑ ROADMAP.md (Analytics) –¥–ª—è FitApp.

–ö–æ–Ω—Ç–µ–∫—Å—Ç:
- –ü—Ä–æ–µ–∫—Ç: /Users/elizavetagolubenko/Projects/fit-tel-bot (–º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø–æ—Å–ª–µ —à–∞–≥–æ–≤ 0.1‚Äì0.2)
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: docs/architecture/design/FIT_APP_SYSTEM_DESIGN.md (—Ä–∞–∑–¥–µ–ª 4 ¬´personal_records¬ª, —Ä–∞–∑–¥–µ–ª 5 ¬´/analytics —Ä–æ—É—Ç—ã¬ª)
- –ü—Ä–∏–∑–º–∞ —Å—Ö–µ–º–∞: apps/bot/prisma/schema.prisma (–∏–ª–∏ –æ–±—â–∞—è –ø–æ—Å–ª–µ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞)
- WorkoutService.approveDraft —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω

–ó–∞–¥–∞—á–∏:
1. Prisma –º–∏–≥—Ä–∞—Ü–∏—è ‚Äî –¥–æ–±–∞–≤–∏—Ç—å –º–æ–¥–µ–ª–∏:
   PersonalRecord (id uuid, user_id FK, exercise_id FK, weight_kg Decimal, reps Int, e1rm Decimal, achieved_in_workout_id FK, achieved_at DateTime)
   Streak (id uuid, user_id FK, current_streak Int, longest_streak Int, last_workout_date Date, shield_count Int, updated_at DateTime)
2. apps/api/src/services/analytics.service.ts:
   - getExerciseProgress(userId, exerciseId, period: '1m'|'3m'|'6m'|'1y'): [{date, maxWeight, totalVolume}]
     –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —á–µ—Ä–µ–∑ Prisma $queryRaw: GROUP BY workout_date, MAX(weight), SUM(reps*weight)
   - getMuscleGroupVolume(userId, period): [{muscleGroup, totalSets, totalVolume}]
     –ß–µ—Ä–µ–∑ exercise.muscle_groups array + JOIN
   - getTrainingFrequency(userId, period): {totalWorkouts, avgPerWeek, streak: StreakInfo}
   - findPersonalRecords(userId): PersonalRecord[] —Å include exercise
   - detectAndSavePR(workoutId): transactionally –Ω–∞–π—Ç–∏ –Ω–æ–≤—ã–µ PR –≤ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–µ –∏ INSERT –≤ personal_records
     –§–æ—Ä–º—É–ª–∞ e1rm: weight * (1 + reps/30) ‚Äî —Ñ–æ—Ä–º—É–ª–∞ Epley
3. apps/api/src/routes/analytics.routes.ts (–≤—Å–µ –∑–∞ JWT middleware):
   GET /api/v1/analytics/progress/:exerciseId?period=3m
   GET /api/v1/analytics/volume?period=1m
   GET /api/v1/analytics/frequency?period=3m
   GET /api/v1/analytics/personal-records
4. –í WorkoutService.approveDraft() –¥–æ–±–∞–≤–∏—Ç—å –≤—ã–∑–æ–≤ analyticsService.detectAndSavePR(workoutId)
5. apps/bot/src/bot/handlers/analyticsHandlers.ts:
   /stats ‚Äî —Å–≤–æ–¥–∫–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü (totalWorkouts, topExercise, currentStreak)
   /progress <—É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ> ‚Äî —Ç–µ–∫—Å—Ç–æ–≤—ã–π –≥—Ä–∞—Ñ–∏–∫: ¬´–ü—Ä–∏—Å–µ–¥: 40–∫–≥ ‚Üí 45–∫–≥ ‚Üí 50–∫–≥¬ª
6. –¢–µ—Å—Ç—ã (src/**/__tests__/):
   analytics.service.test.ts: getExerciseProgress (–º–æ–∫ $queryRaw), detectAndSavePR (–º–æ–∫ prisma)
   analytics.routes.test.ts: –º–æ–∫ analyticsService

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
- $queryRaw –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç unknown ‚Äî –¥–æ–±–∞–≤–∏—Ç—å Zod-–≤–∞–ª–∏–¥–∞—Ü–∏—é —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
- Streak –æ–±–Ω–æ–≤–ª—è—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–∏ approve, –Ω–µ –ø—Ä–∏ draft

Acceptance criteria:
- [ ] pnpm lint && pnpm test ‚Äî –∑–µ–ª—ë–Ω—ã–µ
- [ ] After approve: –µ—Å–ª–∏ –Ω–æ–≤—ã–π –≤–µ—Å –±–æ–ª—å—à–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ max ‚Äî PR —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è
- [ ] GET /analytics/personal-records ‚Üí –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π JSON
- [ ] /stats –≤ –±–æ—Ç–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
```

---

## –§–∞–∑–∞ 1: App MVP (CF-001 ‚Äî CF-004)

> –¶–µ–ª—å: —Ä–∞–±–æ—á–µ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ App Store —Å –±–∞–∑–æ–≤—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫.

### 1.1 Expo-–ø—Ä–æ–µ–∫—Ç, –Ω–∞–≤–∏–≥–∞—Ü–∏—è, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

---

#### üßë‚Äçüíº –î–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç**: –°–æ–∑–¥–∞—ë–º —Å–∞–º–æ –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ‚Äî ¬´—Å–∫–µ–ª–µ—Ç¬ª —Å–æ –≤—Å–µ–º–∏ —ç–∫—Ä–∞–Ω–∞–º–∏ –∏ –≤—Ö–æ–¥–æ–º —á–µ—Ä–µ–∑ Telegram. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–∫–∞—á–∏–≤–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, –≤—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ Telegram –∏ –≤–∏–¥–∏—Ç –ø—É—Å—Ç–æ–π –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω.

**–ß—Ç–æ —É–≤–∏–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**: –≠–∫—Ä–∞–Ω –≤—Ö–æ–¥–∞ ‚Üí –æ–¥–∏–Ω —Ç–∞–ø ¬´–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Telegram¬ª ‚Üí –≥–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω.

**–ú–µ—Ç—Ä–∏–∫–∞ —É—Å–ø–µ—Ö–∞**: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º iPhone/Android, –≤—Ö–æ–¥ —á–µ—Ä–µ–∑ Telegram —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–∞ 2 —Å–µ–∫—É–Ω–¥—ã.

---

#### üßë‚Äçüíª –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: –§–∞–∑–∞ 0 –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ (API + JWT —Ä–∞–±–æ—Ç–∞—é—Ç).

**–ó–∞–¥–∞—á–∏**:

1. `apps/mobile`: `npx create-expo-app@latest --template blank-typescript`
2. Expo Router: –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Ñ–∞–π–ª–æ–≤—É—é –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—é, –≥—Ä—É–ø–ø—ã `(auth)` –∏ `(tabs)`
3. –¢–µ–º–∏–∑–∞—Ü–∏—è: dark/light —Ç–µ–º–∞, —Ü–≤–µ—Ç–æ–≤—ã–µ —Ç–æ–∫–µ–Ω—ã, —Ç–∏–ø–æ–≥—Ä–∞—Ñ–∏–∫–∞ (Google Fonts: Inter)
4. `services/api.ts` ‚Äî Axios –∫–ª–∏–µ–Ω—Ç: `baseURL` –∏–∑ env, `Authorization: Bearer`, –∏–Ω—Ç–µ—Ä—Ü–µ–ø—Ç–æ—Ä –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ refresh —Ç–æ–∫–µ–Ω–∞
5. `store/auth.store.ts` ‚Äî Zustand: `{userId, accessToken, refreshToken, login(), logout()}`
6. `(auth)/login.tsx` ‚Äî —ç–∫—Ä–∞–Ω –≤—Ö–æ–¥–∞: –∫–Ω–æ–ø–∫–∞ ¬´–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Telegram¬ª (WebView Telegram Login Widget) + –∫–Ω–æ–ø–∫–∞ ¬´Email¬ª
7. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤: `expo-secure-store` (Keychain/Keystore)
8. `(tabs)/_layout.tsx` ‚Äî tab bar: –ì–ª–∞–≤–Ω–∞—è, –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞, –ò—Å—Ç–æ—Ä–∏—è, –ö–∞—Ç–∞–ª–æ–≥, –ü—Ä–æ—Ñ–∏–ª—å
9. –¢–µ—Å—Ç—ã: auth.store (jest), api.ts interceptor (axios-mock-adapter)

**Acceptance criteria**:

- [ ] `npx expo start` ‚Äî –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞ iOS Simulator –∏ Android Emulator
- [ ] Telegram OAuth ‚Üí JWT —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ SecureStore
- [ ] –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Å—Ç–∞—ë—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–º (autoLogin)
- [ ] Tab –Ω–∞–≤–∏–≥–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –º–µ–∂–¥—É 5 —ç–∫—Ä–∞–Ω–∞–º–∏

---

#### ü§ñ –ü—Ä–æ–º–ø—Ç –¥–ª—è AI-–∞–≥–µ–Ω—Ç–∞

```prompt
–°–æ–∑–¥–∞–π –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ FitApp –Ω–∞ React Native + Expo (—à–∞–≥ 1.1).

–ö–æ–Ω—Ç–µ–∫—Å—Ç:
- –ú–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: /Users/elizavetagolubenko/Projects/fit-tel-bot
- apps/api —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (–§–∞–∑–∞ 0), –±–∞–∑–æ–≤—ã–π URL: http://localhost:3001/api/v1
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: docs/architecture/design/FIT_APP_SYSTEM_DESIGN.md (—Ä–∞–∑–¥–µ–ª 9)
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è: docs/architecture/design/FIT_APP_SYSTEM_DESIGN.md (—Ä–∞–∑–¥–µ–ª 6)

–ó–∞–¥–∞—á–∏ –≤ apps/mobile/:
1. npx create-expo-app@latest ./ --template blank-typescript
   –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å: expo-router, expo-secure-store, expo-font, axios, zustand, @tanstack/react-query
2. app/_layout.tsx: Stack –Ω–∞–≤–∏–≥–∞—Ü–∏—è, QueryClientProvider, ThemeProvider (dark/light)
3. –¶–≤–µ—Ç–æ–≤—ã–µ —Ç–æ–∫–µ–Ω—ã –≤ constants/Colors.ts: primary #6C63FF, background dark/light, surface, text
4. services/api.ts ‚Äî axios instance:
   - baseURL –∏–∑ expo-constants –∫–æ–Ω—Ñ–∏–≥–∞
   - –ò–Ω—Ç–µ—Ä—Ü–µ–ø—Ç–æ—Ä request: –¥–æ–±–∞–≤–ª—è—Ç—å Authorization: Bearer {accessToken}
   - –ò–Ω—Ç–µ—Ä—Ü–µ–ø—Ç–æ—Ä response: –ø—Ä–∏ 401 ‚Üí POST /auth/refresh ‚Üí –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –∑–∞–ø—Ä–æ—Å ‚Üí –ø—Ä–∏ –æ—à–∏–±–∫–µ ‚Üí logout
5. store/auth.store.ts (Zustand):
   - {userId, accessToken, refreshToken, isLoading}
   - login(tokens): —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ SecureStore + store
   - logout(): –æ—á–∏—Å—Ç–∏—Ç—å SecureStore + store + navigate to /login
   - init(): –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —á–∏—Ç–∞—Ç—å SecureStore ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å exp ‚Üí –µ—Å–ª–∏ –∏—Å—Ç—ë–∫ ‚Üí refresh
6. app/(auth)/login.tsx:
   - WebView –¥–ª—è Telegram Login Widget (–ª–æ–≤–∏—Ç—å redirect —Å hash-–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏)
   - POST /auth/oauth/telegram ‚Üí –ø–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω—ã ‚Üí auth.store.login()
   - –ö–Ω–æ–ø–∫–∞ ¬´–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Email¬ª ‚Üí app/(auth)/register.tsx
7. app/(auth)/register.tsx: —Ñ–æ—Ä–º–∞ email + password ‚Üí POST /auth/register
8. app/(tabs)/_layout.tsx: Tabs –Ω–∞–≤–∏–≥–∞—Ü–∏—è, 5 –≤–∫–ª–∞–¥–æ–∫ —Å –∏–∫–æ–Ω–∫–∞–º–∏ (expo-vector-icons)
9. app/(tabs)/index.tsx: –∑–∞–≥–ª—É—à–∫–∞ ¬´–ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω ‚Äî —Å–∫–æ—Ä–æ –∑–¥–µ—Å—å –ø–æ—è–≤—è—Ç—Å—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏¬ª
10. –¢–µ—Å—Ç—ã (src/__tests__/): auth.store.test.ts (jest, –º–æ–∫ SecureStore)

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
- –ù–ï —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å –±–∏–∑–Ω–µ—Å-—ç–∫—Ä–∞–Ω—ã ‚Äî —Ç–æ–ª—å–∫–æ –Ω–∞–≤–∏–≥–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ StyleSheet, –ù–ï NativeWind/TailwindCSS
- –¢–æ–∫–µ–Ω—ã –¢–û–õ–¨–ö–û –≤ SecureStore, –Ω–µ –≤ AsyncStorage

Acceptance criteria:
- [ ] npx expo start ‚Äî –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- [ ] –í—Ö–æ–¥ —á–µ—Ä–µ–∑ Telegram: —Ç–æ–∫–µ–Ω—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ SecureStore
- [ ] Refresh token –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç (interceptor)
- [ ] –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ ‚Üí autoLogin (–µ—Å–ª–∏ —Ç–æ–∫–µ–Ω—ã –Ω–µ –∏—Å—Ç–µ–∫–ª–∏)
```

---

### 1.2 –ö–∞—Ç–∞–ª–æ–≥ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π

---

#### üßë‚Äçüíº –î–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç**: –î–æ–±–∞–≤–ª—è–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫—É —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è, —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ –≥—Ä—É–ø–ø–∞–º –º—ã—à—Ü –∏ –≤–∏–¥–µ—Ç—å GIF —Å —Ç–µ—Ö–Ω–∏–∫–æ–π.

**–ß—Ç–æ —É–≤–∏–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**: –í–∫–ª–∞–¥–∫–∞ ¬´–ö–∞—Ç–∞–ª–æ–≥¬ª ‚Üí —Å–ø–∏—Å–æ–∫ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π ‚Üí –∫–∞—Ä—Ç–æ—á–∫–∞ —Å GIF, –æ–ø–∏—Å–∞–Ω–∏–µ–º, —á–∞—Å—Ç—ã–º–∏ –æ—à–∏–±–∫–∞–º–∏.

**–î–∞–Ω–Ω—ã–µ**: 1300+ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –∏–∑ –æ—Ç–∫—Ä—ã—Ç–æ–π –±–∞–∑—ã ExerciseDB (—Å –∞–Ω–∏–º–∞—Ü–∏—è–º–∏). –ü–æ–∑–∂–µ –¥–æ–±–∞–≤–∏–º —Å–≤–æ–∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –≤–∏–¥–µ–æ.

**–ú–µ—Ç—Ä–∏–∫–∞ —É—Å–ø–µ—Ö–∞**: –ü–æ–∏—Å–∫ –ø–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—é —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–∞ < 300ms, GIF –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –∫–∞—Ä—Ç–æ—á–∫–∏.

---

#### üßë‚Äçüíª –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: –®–∞–≥ 1.1 –≤—ã–ø–æ–ª–Ω–µ–Ω, `GET /api/v1/exercises` —Ä–∞–±–æ—Ç–∞–µ—Ç.

**–ó–∞–¥–∞—á–∏**:

1. Prisma –º–∏–≥—Ä–∞—Ü–∏—è: —Ä–∞—Å—à–∏—Ä–∏—Ç—å `exercises` (–¥–æ–±–∞–≤–∏—Ç—å `description_ru`, `instructions JSONB`, `common_mistakes JSONB`, `equipment VARCHAR[]`, `gif_url`, `external_id`)
2. `apps/api/src/services/exercise-db.service.ts` ‚Äî ExerciseDB API –∫–ª–∏–µ–Ω—Ç:
   - Fetch —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π —Å GIF URLs
   - –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å –≤ Redis (TTL 24—á)
   - –°–æ—Ö—Ä–∞–Ω—è—Ç—å GIF –Ω–∞ Yandex Object Storage (–∏–ª–∏ –≤–µ—Ä–Ω—É—Ç—å CDN URL)
3. `GET /api/v1/exercises` ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∫–∞ `?search=`, `?muscle_group=`, `?category=`, `?equipment=`, pagination
4. `apps/mobile/app/(tabs)/catalog.tsx` ‚Äî FlatList —Å –ø–æ–∏—Å–∫–æ–º –∏ —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
5. `apps/mobile/components/exercises/ExerciseCard.tsx` ‚Äî –∫–∞—Ä—Ç–æ—á–∫–∞ –≤ —Å–ø–∏—Å–∫–µ
6. `apps/mobile/app/exercises/[id].tsx` ‚Äî –¥–µ—Ç–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞: GIF (expo-image), –æ–ø–∏—Å–∞–Ω–∏–µ, —à–∞–≥–∏ —Ç–µ—Ö–Ω–∏–∫–∏, —á–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏

**Acceptance criteria**:

- [ ] –°–ø–∏—Å–æ–∫ ~1300 —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è (—Å pagination)
- [ ] –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä –ø–æ muscle_group —Ä–∞–±–æ—Ç–∞—é—Ç
- [ ] GIF –∫—ç—à–∏—Ä—É–µ—Ç—Å—è ‚Äî –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ
- [ ] –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ—ë —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ

---

#### ü§ñ –ü—Ä–æ–º–ø—Ç –¥–ª—è AI-–∞–≥–µ–Ω—Ç–∞

```prompt
–†–µ–∞–ª–∏–∑—É–π –∫–∞—Ç–∞–ª–æ–≥ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –¥–ª—è FitApp (—à–∞–≥ 1.2).

–ö–æ–Ω—Ç–µ–∫—Å—Ç:
- –ú–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: /Users/elizavetagolubenko/Projects/fit-tel-bot
- System design: docs/architecture/design/FIT_APP_SYSTEM_DESIGN.md (—Ä–∞–∑–¥–µ–ª 8)
- –ë–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è: FIT_APP_BUSINESS_REQUIREMENTS.md (CF-002)
- Prisma —Å—Ö–µ–º–∞: apps/bot/prisma/schema.prisma ‚Äî –º–æ–¥–µ–ª—å Exercise —É–∂–µ –µ—Å—Ç—å, –Ω—É–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å
- ExerciseDB API: https://exercisedb.p.rapidapi.com (–Ω—É–∂–µ–Ω RAPIDAPI_KEY –≤ .env)

–ó–∞–¥–∞—á–∏ –≤ apps/api:
1. Prisma –º–∏–≥—Ä–∞—Ü–∏—è ‚Äî ALTER exercises:
   description_ru TEXT, instructions JSONB, common_mistakes JSONB,
   equipment VARCHAR[], bodyweight BOOLEAN DEFAULT false,
   gif_url TEXT, gif_cached_at TIMESTAMP, external_id VARCHAR
2. src/services/exercise-db.service.ts:
   - fetchAllExercises(): GET https://exercisedb.p.rapidapi.com/exercises (limit 1300)
   - –°–æ—Ö—Ä–∞–Ω—è—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≤ exercises, gif_url –æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å (CDN ExerciseDB)
   - –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ –≤ Redis (TTL 86400s)
   - –ó–∞–ø—É—Å—Ç–∏—Ç—å sync –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –µ—Å–ª–∏ exercises < 100
3. GET /api/v1/exercises ‚Äî Fastify route:
   Query params: search (ILIKE), muscleGroup, category, equipment, page, limit (default 20)
   Response: {data: Exercise[], total, page, totalPages}
4. GET /api/v1/exercises/:id ‚Äî –≤–∫–ª—é—á–∞—è instructions –∏ common_mistakes
5. POST /api/v1/exercises ‚Äî —Å–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ (is_global=false, created_by=req.userId)

–ó–∞–¥–∞—á–∏ –≤ apps/mobile:
6. app/(tabs)/catalog.tsx:
   - FlatList —Å ExerciseCard (useInfiniteQuery –∏–∑ TanStack Query)
   - SearchBar (debounce 300ms)
   - MuscleGroupFilter ‚Äî –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π —Å–∫—Ä–æ–ª–ª —á–∏–ø–æ–≤
7. components/exercises/ExerciseCard.tsx ‚Äî –Ω–∞–∑–≤–∞–Ω–∏–µ, –º—ã—à–µ—á–Ω–∞—è –≥—Ä—É–ø–ø–∞, –∏–∫–æ–Ω–∫–∞
8. app/exercises/[id].tsx:
   - expo-image –¥–ª—è GIF (contentFit='contain', cachePolicy='memory-disk')
   - –°–ø–∏—Å–æ–∫ steps –∏–∑ instructions
   - –°–µ–∫—Ü–∏—è ¬´–ß–∞—Å—Ç—ã–µ –æ—à–∏–±–∫–∏¬ª
   - –ö–Ω–æ–ø–∫–∞ ¬´–î–æ–±–∞–≤–∏—Ç—å –≤ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É¬ª

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
- GIF –ù–ï —Å–∫–∞—á–∏–≤–∞—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å URL –∏–∑ ExerciseDB –Ω–∞–ø—Ä—è–º—É—é
- –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π tier ExerciseDB: 10 req/–º–∏–Ω ‚Äî –∫—ç—à –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω
- exercises.is_global=true –¥–ª—è ExerciseDB, false –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö

Acceptance criteria:
- [ ] pnpm lint && pnpm test ‚Äî –∑–µ–ª—ë–Ω—ã–µ
- [ ] GET /exercises?search=squat ‚Üí —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –ø–æ –∏–º–µ–Ω–∏
- [ ] –°–ø–∏—Å–æ–∫ –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–º –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –ø–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω–æ
- [ ] GIF –∫—ç—à–∏—Ä—É–µ—Ç—Å—è –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ (–ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ –±–µ–∑ —Å–µ—Ç–∏)
```

---

### 1.3 –°–æ–∑–¥–∞–Ω–∏–µ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏

---

#### üßë‚Äçüíº –î–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç**: –î–æ–±–∞–≤–ª—è–µ–º –≥–ª–∞–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ‚Äî —Å–æ–∑–¥–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É –∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å –µ—ë –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ —Å —Ç–∞–π–º–µ—Ä–æ–º –∏ —Å—á—ë—Ç—á–∏–∫–æ–º.

**–ß—Ç–æ —É–≤–∏–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**: –ö–Ω–æ–ø–∫–∞ ¬´–ù–∞—á–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É¬ª ‚Üí –≤—ã–±–æ—Ä —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π ‚Üí –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å —Ç–∞–π–º–µ—Ä–æ–º –æ—Ç–¥—ã—Ö–∞ ‚Üí —Å–∞–¥–∂–µ—Å—Ç –≤–µ—Å–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ—à–ª—ã—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ ‚Üí –∏—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞.

**–ú–µ—Ç—Ä–∏–∫–∞ —É—Å–ø–µ—Ö–∞**: –ú–∞–∫—Å–∏–º—É–º 2 —Ç–∞–ø–∞ –æ—Ç –≥–ª–∞–≤–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞ –¥–æ –Ω–∞—á–∞–ª–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏.

---

#### üßë‚Äçüíª –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: –®–∞–≥–∏ 1.1, 1.2 –≤—ã–ø–æ–ª–Ω–µ–Ω—ã.

**–ó–∞–¥–∞—á–∏**:

1. `GET /api/v1/workouts/active-draft` ‚Äî –Ω–∞–π—Ç–∏ –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—É—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É (status=draft)
2. `GET /api/v1/workouts/heatmap` ‚Äî –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–µ–ø–ª–æ–≤–æ–π –∫–∞—Ä—Ç—ã –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
3. `apps/mobile/store/workoutSession.store.ts` (Zustand):
   - `{workoutId, exercises[], currentExerciseIndex, currentSetIndex, timer}`
   - `startWorkout()`, `logSet(reps, weight)`, `nextExercise()`, `finishWorkout()`
   - Offline queue: pending sets ‚Üí MMKV, sync –ø—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ —Å–µ—Ç–∏
4. `app/(tabs)/workout.tsx` ‚Äî —Ä–µ–∂–∏–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:
   - ExerciseRow —Å currentSet, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–º –≤–µ—Å–æ–º (–∏–∑ analytics.getExerciseProgress)
   - `SetLogger` ‚Äî –≤–≤–æ–¥ reps + weight + –∫–Ω–æ–ø–∫–∞ ‚úì
   - `RestTimer` ‚Äî –æ–±—Ä–∞—Ç–Ω—ã–π –æ—Ç—Å—á—ë—Ç (60/90/120 —Å–µ–∫), —Å–±—Ä–æ—Å –∏ –∑–∞–ø—É—Å–∫ –≥–æ–ª–æ—Å–æ–º (–§–∞–∑–∞ 2)
5. `app/workouts/new.tsx` ‚Äî —Å–æ–∑–¥–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É:
   - –ü–æ–∏—Å–∫ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞, drag & drop –ø–æ—Ä—è–¥–∫–∞ (react-native-draggable-flatlist)
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ–¥—Ö–æ–¥—ã / –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è / –≤–µ—Å
6. `app/(tabs)/index.tsx` (–ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω):
   - –ë–∞–Ω–Ω–µ—Ä ¬´–ï—Å—Ç—å –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞¬ª (–µ—Å–ª–∏ active-draft)
   - –ö–Ω–æ–ø–∫–∞ ¬´–ë—ã—Å—Ç—Ä–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞¬ª (15 –º–∏–Ω, —à–∞–±–ª–æ–Ω)
   - –¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ `ActivityHeatmap` (SVG)
7. –ò—Ç–æ–≥–æ–≤–∞—è —Å–≤–æ–¥–∫–∞ –ø–æ—Å–ª–µ `POST /workouts/:id/approve`: –æ–±—ä—ë–º, —Ç–æ–Ω–Ω–∞–∂, –≤—Ä–µ–º—è, PR badge –µ—Å–ª–∏ PR

**Acceptance criteria**:

- [ ] –û—Ç –≥–ª–∞–≤–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞ –¥–æ —Å—Ç–∞—Ä—Ç–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ ‚Äî 2 —Ç–∞–ø–∞
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç offline (pending queue)
- [ ] –¢–∞–π–º–µ—Ä –æ—Ç–¥—ã—Ö–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- [ ] –°–∞–¥–∂–µ—Å—Ç –≤–µ—Å–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø–æ—Å–ª–µ–¥–Ω–µ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏

---

#### ü§ñ –ü—Ä–æ–º–ø—Ç –¥–ª—è AI-–∞–≥–µ–Ω—Ç–∞

```prompt
–†–µ–∞–ª–∏–∑—É–π —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –¥–ª—è FitApp (—à–∞–≥ 1.3).

–ö–æ–Ω—Ç–µ–∫—Å—Ç:
- –ú–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: /Users/elizavetagolubenko/Projects/fit-tel-bot
- –ë–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è: FIT_APP_BUSINESS_REQUIREMENTS.md (CF-003, CF-004)
- System design: docs/architecture/design/FIT_APP_SYSTEM_DESIGN.md (—Ä–∞–∑–¥–µ–ª—ã 5, 10)
- –®–∞–≥–∏ 1.1 –∏ 1.2 –≤—ã–ø–æ–ª–Ω–µ–Ω—ã: –Ω–∞–≤–∏–≥–∞—Ü–∏—è, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, –∫–∞—Ç–∞–ª–æ–≥ —Ä–∞–±–æ—Ç–∞—é—Ç

–ó–∞–¥–∞—á–∏ –≤ apps/api:
1. GET /api/v1/workouts/active-draft ‚Äî –Ω–∞–π—Ç–∏ workout {user_id, status='draft'}, –≤–µ—Ä–Ω—É—Ç—å —Å exercises
2. GET /api/v1/workouts/heatmap?year=2026 ‚Äî [{date: 'YYYY-MM-DD', count: N}]
3. GET /api/v1/analytics/weight-suggestion/:exerciseId ‚Äî –ø–æ—Å–ª–µ–¥–Ω–∏–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–π –≤–µ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

–ó–∞–¥–∞—á–∏ –≤ apps/mobile:
4. store/workoutSession.store.ts (Zustand + MMKV persist):
   workoutId: string | null
   exercises: {exerciseId, name, sets: {reps, weight, logged}[]}[]
   currentExerciseIdx: number
   restTimerSeconds: number
   pendingSets: {workoutId, exerciseId, setData}[] ‚Äî –¥–ª—è offline
   actions: startWorkout, logSet, syncPendingSets, finishWorkout
5. hooks/useWorkoutSync.ts ‚Äî –ø—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ —Å–µ—Ç–∏ (@react-native-community/netinfo):
   –ø–µ—Ä–µ–±–∏—Ä–∞–µ–º pendingSets ‚Üí PUT /workouts/:id ‚Üí –æ—á–∏—â–∞–µ–º
6. app/workouts/new.tsx:
   - –°–ø–∏—Å–æ–∫ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π —Å –ø–æ–∏—Å–∫–æ–º (–∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞)
   - Drag-and-drop (react-native-draggable-flatlist) –¥–ª—è –ø–æ—Ä—è–¥–∫–∞
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ: –≤–≤–æ–¥ defaultSets, defaultReps, defaultWeight
   - POST /workouts ‚Üí navigate to /workouts/execute/:id
7. app/workouts/execute/[id].tsx:
   - –¢–µ–∫—É—â–µ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ + –Ω–æ–º–µ—Ä —Å–µ—Ç–∞
   - –°–∞–¥–∂–µ—Å—Ç –≤–µ—Å–∞ (–∏–∑ /analytics/weight-suggestion/:exerciseId)
   - SetLogger: NumericInput –¥–ª—è reps + weight + –∫–Ω–æ–ø–∫–∞ ‚úì ‚Üí logSet()
   - RestTimer: react-native-countdown-circle-timer, 60/90/120 —Å–µ–∫
   - –ö–Ω–æ–ø–∫–∞ ¬´–°–ª–µ–¥—É—é—â–µ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ¬ª
   - FAB ¬´–ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É¬ª ‚Üí POST /workouts/:id/approve ‚Üí SummaryModal
8. components/workout/SummaryModal.tsx:
   - –ü–æ–∫–∞–∑–∞—Ç—å: totalVolume, totalSets, duration, PRs achieved (–µ—Å–ª–∏ –µ—Å—Ç—å)
   - –ö–Ω–æ–ø–∫–∞ ¬´–ì–æ—Ç–æ–≤–æ¬ª
9. app/(tabs)/index.tsx (–ì–ª–∞–≤–Ω—ã–π —ç–∫—Ä–∞–Ω):
   - useQuery(['active-draft']) ‚Üí –±–∞–Ω–Ω–µ—Ä –µ—Å–ª–∏ –µ—Å—Ç—å
   - –ö–Ω–æ–ø–∫–∞ ¬´–ù–∞—á–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É¬ª ‚Üí /workouts/new
   - ActivityHeatmap (SVG —á–µ—Ä–µ–∑ react-native-svg, –¥–∞–Ω–Ω—ã–µ –∏–∑ /heatmap)
10. –¢–µ—Å—Ç—ã: workoutSession.store.test.ts (logSet, sync offline)

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
- Offline: MMKV –¥–ª—è pendingSets, sync –ø—Ä–∏ reconnect
- PR badge: –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø–æ—Å–ª–µ approve —á–µ—Ä–µ–∑ /analytics/personal-records

Acceptance criteria:
- [ ] 2 —Ç–∞–ø–∞ –æ—Ç –≥–ª–∞–≤–Ω–æ–≥–æ –¥–æ –Ω–∞—á–∞–ª–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
- [ ] Offline –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí sync –ø—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ —Å–µ—Ç–∏
- [ ] RestTimer –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ logSet
- [ ] SummaryModal –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç PR –µ—Å–ª–∏ –ø–æ–±–∏—Ç —Ä–µ–∫–æ—Ä–¥
```

---

### 1.4 –ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫

---

#### üßë‚Äçüíº –î–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç**: –≠–∫—Ä–∞–Ω –∏—Å—Ç–æ—Ä–∏–∏ ‚Äî —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ —Å –¥–µ—Ç–∞–ª—è–º–∏, –ª–∏—á–Ω—ã–º–∏ —Ä–µ–∫–æ—Ä–¥–∞–º–∏ –∏ —Ç–µ–ø–ª–æ–≤–æ–π –∫–∞—Ä—Ç–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏. –¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ ‚Äî –∫–∞–∫ GitHub contributions ‚Äî –º–æ—â–Ω—ã–π –º–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç.

**–ú–µ—Ç—Ä–∏–∫–∞ —É—Å–ø–µ—Ö–∞**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –∑–∞ –≥–æ–¥ –æ–¥–Ω–∏–º —Å–∫—Ä–æ–ª–ª–æ–º, —Ç–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ –ø–æ–∫–∞–∑–∞–Ω–∞ –Ω–∞ –≥–ª–∞–≤–Ω–æ–º —ç–∫—Ä–∞–Ω–µ.

---

#### üßë‚Äçüíª –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

**–ó–∞–¥–∞—á–∏**:

1. `app/(tabs)/history.tsx`:
   - `useInfiniteQuery` –ø–æ `GET /api/v1/workouts?status=approved&page=N`
   - `WorkoutHistoryCard` ‚Äî –¥–∞—Ç–∞, —Ñ–æ–∫—É—Å (–º—ã—à–µ—á–Ω—ã–µ –≥—Ä—É–ø–ø—ã), —Ç–æ–Ω–Ω–∞–∂
2. `app/workouts/[id].tsx` (–¥–µ—Ç–∞–ª–∏):
   - –°–ø–∏—Å–æ–∫ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π –∏ –ø–æ–¥—Ö–æ–¥–æ–≤
   - PR badges —Ä—è–¥–æ–º —Å –≤–µ—Å–æ–º –µ—Å–ª–∏ —ç—Ç–æ –±—ã–ª —Ä–µ–∫–æ—Ä–¥
3. `GET /api/v1/workouts` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å `?status=approved&dateFrom=&dateTo=` —Ñ–∏–ª—å—Ç—Ä—ã + cursor-based pagination

**Acceptance criteria**:

- [ ] –ò—Å—Ç–æ—Ä–∏—è 50+ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ infinite scroll
- [ ] PR –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è —Ä—è–¥–æ–º —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º –ø–æ–¥—Ö–æ–¥–æ–º
- [ ] –ù–∞–∂–∞—Ç–∏–µ –Ω–∞ –¥–µ–Ω—å –≤ —Ç–µ–ø–ª–æ–≤–æ–π –∫–∞—Ä—Ç–µ ‚Üí –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É –∑–∞ —ç—Ç–æ—Ç –¥–µ–Ω—å

---

#### ü§ñ –ü—Ä–æ–º–ø—Ç –¥–ª—è AI-–∞–≥–µ–Ω—Ç–∞

```prompt
–†–µ–∞–ª–∏–∑—É–π —ç–∫—Ä–∞–Ω –∏—Å—Ç–æ—Ä–∏–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –¥–ª—è FitApp (—à–∞–≥ 1.4).

–ö–æ–Ω—Ç–µ–∫—Å—Ç:
- –ú–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: /Users/elizavetagolubenko/Projects/fit-tel-bot
- –ë–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è: FIT_APP_BUSINESS_REQUIREMENTS.md (CF-004)
- –®–∞–≥–∏ 1.1‚Äì1.3 –≤—ã–ø–æ–ª–Ω–µ–Ω—ã

–ó–∞–¥–∞—á–∏ –≤ apps/api:
1. GET /api/v1/workouts ‚Äî —Ä–∞—Å—à–∏—Ä–∏—Ç—å: cursor-based pagination (cursor=lastId), —Ñ–∏–ª—å—Ç—Ä—ã status, dateFrom, dateTo
2. GET /api/v1/workouts/:id ‚Äî include: workout_exercises ‚Üí exercise ‚Üí exercise_sets, include: personal_records (–±—ã–ª –ª–∏ PR –≤ —ç—Ç–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–µ)

–ó–∞–¥–∞—á–∏ –≤ apps/mobile:
3. app/(tabs)/history.tsx:
   - useInfiniteQuery(['workouts'], fetchWorkouts
   - FlatList WorkoutHistoryCard: –¥–∞—Ç–∞, —Ñ–æ–∫—É—Å (emoji –º—ã—à—Ü), totalVolume (–∫–≥), duration
   - Pull-to-refresh
4. components/workout/WorkoutHistoryCard.tsx: –∫—Ä–∞—Å–∏–≤–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ —Å gradients
5. app/workouts/[id].tsx:
   - –°–ø–∏—Å–æ–∫ exercises ‚Üí sets —Å PRüèÜ badge –µ—Å–ª–∏ achieved_in_workout_id —Å–æ–≤–ø–∞–¥–∞–µ—Ç
   - –ö–Ω–æ–ø–∫–∞ ¬´–ü–æ–≤—Ç–æ—Ä–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É¬ª ‚Üí —Å–æ–∑–¥–∞—Ç—å –∫–æ–ø–∏—é –∫–∞–∫ draft
6. –¢–∞–∫–∂–µ –Ω–∞ app/(tabs)/index.tsx: ActivityHeatmap –∫–ª–∏–∫–∞–±–µ–ª—å–Ω–∞:
   - –¢–∞–ø –Ω–∞ –¥–µ–Ω—å ‚Üí router.push('/workouts?date=YYYY-MM-DD')
   - GET /api/v1/workouts?date= ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É –∑–∞ —ç—Ç–æ—Ç –¥–µ–Ω—å

Acceptance criteria:
- [ ] –ò—Å—Ç–æ—Ä–∏—è —Å infinite scroll, 20 –∑–∞–ø–∏—Å–µ–π –∑–∞ —Ä–∞–∑
- [ ] PR üèÜ –≤–∏–¥–µ–Ω —Ä—è–¥–æ–º —Å —Ä–µ–∫–æ—Ä–¥–Ω—ã–º –ø–æ–¥—Ö–æ–¥–æ–º
- [ ] –¢–µ–ø–ª–æ–≤–∞—è –∫–∞—Ä—Ç–∞ ‚Üí –Ω–∞–∂–∞—Ç–∏–µ ‚Üí –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É –∑–∞ —ç—Ç–æ—Ç –¥–µ–Ω—å
- [ ] ¬´–ü–æ–≤—Ç–æ—Ä–∏—Ç—å —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É¬ª —Å–æ–∑–¥–∞—ë—Ç —á–µ—Ä–Ω–æ–≤–∏–∫ —Å —Ç–µ–º–∏ –∂–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è–º–∏
```

---

## –§–∞–∑–∞ 2: –ì–æ–ª–æ—Å + –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (PH2-005 ‚Äî PH2-007)

> –¶–µ–ª—å: hands-free —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –∏ —Å–∏—Å—Ç–µ–º–∞ –º–æ—Ç–∏–≤–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.

### 2.1 –ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥ –∏ Hands-free —Ä–µ–∂–∏–º

---

#### üßë‚Äçüíº –î–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç**: –î–æ–±–∞–≤–ª—è–µ–º –≥–æ–ª–æ—Å–æ–≤–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–æ–π. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –ø—Ä–æ—Å—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç ¬´—á–µ—Ç—ã—Ä–µ –ø–æ–≤—Ç–æ—Ä–∞, –≤–µ—Å –≤–æ—Å–µ–º—å–¥–µ—Å—è—Ç –ø—è—Ç—å¬ª ‚Äî —Å–∏—Å—Ç–µ–º–∞ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç. –ù–∏–∫–∞–∫–æ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å —ç–∫—Ä–∞–Ω–æ–º, —Ä—É–∫–∏ —Å–≤–æ–±–æ–¥–Ω—ã.

**–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ**: –ù–∏ –æ–¥–∏–Ω –∫—Ä—É–ø–Ω—ã–π –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç (Strava, MyFitnessPal, Fitbod) –Ω–µ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π hands-free —Ä–µ–∂–∏–º. –≠—Ç–æ –∫–ª—é—á–µ–≤–æ–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ.

**–ß—Ç–æ —É—Å–ª—ã—à–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å**: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≥–æ–ª–æ—Å–æ–º ¬´85 –∫–≥, 4 –ø–æ–≤—Ç–æ—Ä–∞ ‚Äî –∑–∞–ø–∏—Å–∞–Ω–æ¬ª + –≤–∏–±—Ä–∞—Ü–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞.

**–ú–µ—Ç—Ä–∏–∫–∞ —É—Å–ø–µ—Ö–∞**: 70%+ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≥–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥ —Ö–æ—Ç—è –±—ã —Ä–∞–∑ –∑–∞ –ø–µ—Ä–≤—É—é –Ω–µ–¥–µ–ª—é.

---

#### üßë‚Äçüíª –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: –®–∞–≥–∏ 1.1‚Äì1.4 –≤—ã–ø–æ–ª–Ω–µ–Ω—ã, `POST /stt/transcribe` –∏ `POST /nlu/parse-voice-command` —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ –§–∞–∑–µ 0.

**–ó–∞–¥–∞—á–∏**:

1. `apps/mobile/hooks/useVoiceRecorder.ts`:
   - `expo-av` / `expo-audio` –¥–ª—è –∑–∞–ø–∏—Å–∏
   - iOS: `AVAudioSession.setCategory(.playAndRecord)` —á–µ—Ä–µ–∑ `expo-av`
   - Android: `MediaRecorder` —á–µ—Ä–µ–∑ `expo-av`
   - –ú–µ—Ç–æ–¥—ã: `startRecording()`, `stopRecording(): File`, `requestPermission()`
2. `apps/mobile/components/workout/VoiceButton.tsx`:
   - –ë–æ–ª—å—à–∞—è –∫–Ω–æ–ø–∫–∞ —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π (react-native-reanimated –ø—É–ª—å—Å –ø—Ä–∏ –∑–∞–ø–∏—Å–∏)
   - longPress ‚Üí –∑–∞–ø–∏—Å—å, release ‚Üí –æ—Ç–ø—Ä–∞–≤–∫–∞
3. Flow: –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å ‚Üí `POST /stt/transcribe` ‚Üí `POST /nlu/parse-voice-command` ‚Üí `workoutSession.logSet()`
4. `apps/mobile/utils/audio-feedback.ts`:
   - `expo-speech`: TTS –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ ¬´85 –∫–≥, 4 –ø–æ–≤—Ç–æ—Ä–∞ ‚Äî –∑–∞–ø–∏—Å–∞–Ω–æ¬ª
   - `expo-haptics`: `Haptics.impactAsync(ImpactFeedbackStyle.Medium)` –ø—Ä–∏ —É—Å–ø–µ—Ö–µ
5. Background Audio (iOS): `app.json` ‚Üí `infoPlist.UIBackgroundModes: ["audio"]`
6. –¢–µ—Å—Ç—ã: `useVoiceRecorder.test.ts` (–º–æ–∫ expo-av), `audio-feedback.test.ts`

**Acceptance criteria**:

- [ ] –ì–æ–ª–æ—Å–æ–≤–∞—è –∑–∞–ø–∏—Å—å —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–º —ç–∫—Ä–∞–Ω–µ (iOS)
- [ ] STT ‚Üí NLU ‚Üí logSet –∑–∞ < 3 —Å–µ–∫—É–Ω–¥—ã
- [ ] Haptic feedback –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–∏
- [ ] TTS –ø—Ä–æ–∏–∑–Ω–æ—Å–∏—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ

---

#### ü§ñ –ü—Ä–æ–º–ø—Ç –¥–ª—è AI-–∞–≥–µ–Ω—Ç–∞

```prompt
–†–µ–∞–ª–∏–∑—É–π –≥–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥ –∏ hands-free —Ä–µ–∂–∏–º –¥–ª—è FitApp (—à–∞–≥ 2.1).

–ö–æ–Ω—Ç–µ–∫—Å—Ç:
- –ú–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: /Users/elizavetagolubenko/Projects/fit-tel-bot
- –ë–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è: FIT_APP_BUSINESS_REQUIREMENTS.md (PH2-007 ¬´–ì–æ–ª–æ—Å–æ–≤–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ¬ª)
- System design: docs/architecture/design/FIT_APP_SYSTEM_DESIGN.md (—Ä–∞–∑–¥–µ–ª 7)
- POST /stt/transcribe –∏ POST /nlu/parse-voice-command —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ apps/api (–§–∞–∑–∞ 0)
- –†–µ–∂–∏–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏: app/workouts/execute/[id].tsx (—à–∞–≥ 1.3)

–ó–∞–¥–∞—á–∏ –≤ apps/mobile:
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å: expo-av, expo-speech, expo-haptics, react-native-reanimated@3
2. hooks/useVoiceRecorder.ts:
   - requestMicPermission(): Promise<boolean>
   - startRecording(): Promise<void> ‚Äî Audio.Recording —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ AAC
   - stopAndTranscribe(): Promise<VoiceCommand | null>
     –í–Ω—É—Ç—Ä–∏: stopRecording ‚Üí getURI ‚Üí fetch file ‚Üí FormData ‚Üí POST /stt/transcribe ‚Üí POST /nlu/parse-voice-command
   - state: {isRecording, isProcessing, lastCommand}
3. components/workout/VoiceButton.tsx:
   - –ë–æ–ª—å—à–∞—è –∫—Ä—É–≥–ª–∞—è –∫–Ω–æ–ø–∫–∞ (80px) —Å –∏–∫–æ–Ω–∫–æ–π –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞
   - –ü—Ä–∏ isRecording: Animated –ø—É–ª—å—Å–∏—Ä—É—é—â–∏–π –∫—Ä–∞—Å–Ω—ã–π –∫—Ä—É–≥ (useAnimatedStyle)
   - –ü—Ä–∏ isProcessing: ActivityIndicator
   - –û–±—Ä–∞–±–æ—Ç–∫–∞: onLongPress ‚Üí startRecording(), onPressOut ‚Üí stopAndTranscribe()
4. utils/audio-feedback.ts:
   - speakConfirmation(reps, weight, unit): Speech.speak(`${weight} ${unit}, ${reps} –ø–æ–≤—Ç–æ—Ä–∞ ‚Äî –∑–∞–ø–∏—Å–∞–Ω–æ`)
   - hapticSuccess(): Haptics.impactAsync(ImpactFeedbackStyle.Medium)
   - hapticError(): Haptics.notificationAsync(NotificationFeedbackType.Error)
5. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å VoiceButton –≤ app/workouts/execute/[id].tsx:
   - –ü—Ä–∏ VoiceCommand.command === 'log_set': workoutSession.logSet(reps, weight) + speakConfirmation + hapticSuccess
   - –ü—Ä–∏ 'next_exercise': workoutSession.nextExercise() + Speech.speak('–°–ª–µ–¥—É—é—â–µ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ')
   - –ü—Ä–∏ 'finish_workout': –ø–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ ‚Üí finishWorkout()
6. app.json (iOS): expo.ios.infoPlist.UIBackgroundModes: ['audio']
   expo.ios.infoPlist.NSMicrophoneUsageDescription: '–î–ª—è –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–æ–π'
7. –¢–µ—Å—Ç—ã:
   useVoiceRecorder.test.ts: –º–æ–∫ expo-av (Audio.Recording), —É—Å–ø–µ—à–Ω–∞—è —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è, –æ—à–∏–±–∫–∞ API
   audio-feedback.test.ts: speakConfirmation –≤—ã–∑—ã–≤–∞–µ—Ç Speech.speak —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
- –ü—Ä–∏ –æ—à–∏–±–∫–µ STT/NLU ‚Äî hapticError() + –ø–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—Å—Ç ¬´–ù–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–ª, –ø–æ–ø—Ä–æ–±—É–π –µ—â—ë¬ª
- –ù–ï —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∞—É–¥–∏–æ —Ñ–∞–π–ª –ø–æ—Å–ª–µ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–∏

Acceptance criteria:
- [ ] pnpm lint && pnpm test ‚Äî –∑–µ–ª—ë–Ω—ã–µ
- [ ] –ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥ ¬´—á–µ—Ç—ã—Ä–µ –ø–æ–≤—Ç–æ—Ä–∞ –≤–µ—Å –≤–æ—Å–µ–º—å–¥–µ—Å—è—Ç –ø—è—Ç—å¬ª ‚Üí logSet(4, 85)
- [ ] TTS –≥–æ–≤–æ—Ä–∏—Ç ¬´85 –∫–≥, 4 –ø–æ–≤—Ç–æ—Ä–∞ ‚Äî –∑–∞–ø–∏—Å–∞–Ω–æ¬ª
- [ ] Haptic –ø—Ä–∏ —É—Å–ø–µ—Ö–µ, –¥—Ä—É–≥–æ–π haptic –ø—Ä–∏ –æ—à–∏–±–∫–µ
- [ ] iOS Background Audio mode –≤–∫–ª—é—á—ë–Ω –≤ app.json
```

---

### 2.2 Push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ Streak-—Å–∏—Å—Ç–µ–º–∞

---

#### üßë‚Äçüíº –î–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç**: –î–æ–±–∞–≤–ª—è–µ–º —Å–∏—Å—Ç–µ–º—É –º–æ—Ç–∏–≤–∞—Ü–∏–∏ ‚Äî —Å–µ—Ä–∏–∏ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ (streaks), –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∏ —É–º–Ω—ã–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞–ø–æ–º–Ω–∏—Ç ¬´–ù–µ –∑–∞–±—É–¥—å —Å–µ–≥–æ–¥–Ω—è –ø–æ—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è¬ª –∑–∞ 2 —á–∞—Å–∞ –¥–æ –∫–æ–Ω—Ü–∞ –¥–Ω—è, –∞ –ø—Ä–∏ –ª–∏—á–Ω–æ–º —Ä–µ–∫–æ—Ä–¥–µ ‚Äî –ø–æ–∑–¥—Ä–∞–≤–∏—Ç.

**–î–∞–Ω–Ω—ã–µ –ø–æ —Ä—ã–Ω–∫—É**: –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏ –∏–º–µ—é—Ç –Ω–∞ 45% –≤—ã—à–µ Day-7 retention.

**–ú–µ—Ç—Ä–∏–∫–∞ —É—Å–ø–µ—Ö–∞**: 60%+ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Ä–∞–∑—Ä–µ—à–∞—é—Ç push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ.

---

#### üßë‚Äçüíª –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: –®–∞–≥–∏ 1.1‚Äì1.4, –§–∞–∑–∞ 0 –≤—ã–ø–æ–ª–Ω–µ–Ω—ã.

**–ó–∞–¥–∞—á–∏**:

1. `apps/api`: —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `bullmq`, `firebase-admin` (FCM), `node-apn` (APNs)
2. `apps/api/src/workers/notification.worker.ts` ‚Äî BullMQ –≤–æ—Ä–∫–µ—Ä:
   - `streak_reminder`: –Ω–∞–π—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ —Å–µ–≥–æ–¥–Ω—è, —á–∞—Å = 22:00 –ø–æ TZ ‚Üí push
   - `pr_achieved`: –ø—É—à –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ PR –≤ `detectAndSavePR()`
   - `scheduled_workout`: –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –ø–æ `workout_schedule`
3. `apps/api/src/services/push.service.ts`:
   - `sendPush(userId, title, body, data)` ‚Äî —á–∏—Ç–∞–µ—Ç `push_tokens`, –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç platform, APNs –∏–ª–∏ FCM
4. `apps/api/src/routes/users.routes.ts`: `POST /users/me/push-token`, `DELETE /users/me/push-token/:token`
5. Prisma –º–∏–≥—Ä–∞—Ü–∏—è: —Ç–∞–±–ª–∏—Ü—ã `push_tokens`, `achievements`, `user_achievements`, `streaks`
6. `apps/mobile`: —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `expo-notifications`
7. `apps/mobile/hooks/usePushNotifications.ts`:
   - `registerForPushNotifications()`: –∑–∞–ø—Ä–æ—Å–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ ‚Üí –ø–æ–ª—É—á–∏—Ç—å token ‚Üí POST `/users/me/push-token`
   - –í—ã–∑–≤–∞—Ç—å –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ
8. –¢–µ—Å—Ç—ã: push.service (–º–æ–∫ firebase-admin, node-apn), notification.worker (–º–æ–∫ bullmq job)

**Acceptance criteria**:

- [ ] –ü–æ—Å–ª–µ approve —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ —Å PR ‚Üí push –ø—Ä–∏—Ö–æ–¥–∏—Ç –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
- [ ] Streak –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ approve —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
- [ ] –ü—Ä–∏ –ø—Ä–æ–ø—É—Å–∫–µ –¥–Ω—è streak —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è (–Ω–æ Shield –∑–∞—â–∏—â–∞–µ—Ç)
- [ ] Push –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –ø–æ timezone –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

#### ü§ñ –ü—Ä–æ–º–ø—Ç –¥–ª—è AI-–∞–≥–µ–Ω—Ç–∞

```prompt
–†–µ–∞–ª–∏–∑—É–π push-—É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∏ streak-—Å–∏—Å—Ç–µ–º—É –¥–ª—è FitApp (—à–∞–≥ 2.2).

–ö–æ–Ω—Ç–µ–∫—Å—Ç:
- –ú–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: /Users/elizavetagolubenko/Projects/fit-tel-bot
- –ë–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è: FIT_APP_BUSINESS_REQUIREMENTS.md (PH2-005 ¬´–°–∏—Å—Ç–µ–º–∞ –º–æ—Ç–∏–≤–∞—Ü–∏–∏¬ª, KF-006 ¬´Streak Shield¬ª)
- System design: docs/architecture/design/FIT_APP_SYSTEM_DESIGN.md (—Ä–∞–∑–¥–µ–ª 11)
- –§–∞–∑–∞ 0 –∏ —à–∞–≥–∏ 1.1‚Äì1.4 –≤—ã–ø–æ–ª–Ω–µ–Ω—ã
- detectAndSavePR() –≤ analytics.service.ts —É–∂–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ approve (—à–∞–≥ 0.3)

–ó–∞–¥–∞—á–∏ –≤ apps/api:
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å: bullmq, firebase-admin, node-apn
2. –î–æ–±–∞–≤–∏—Ç—å –≤ .env: FCM_SERVICE_ACCOUNT_JSON (base64), APNS_KEY_P8 (base64), APNS_KEY_ID, APNS_TEAM_ID
3. Prisma –º–∏–≥—Ä–∞—Ü–∏—è:
   - PushToken (id, user_id FK, platform 'ios'|'android', token, app_version, created_at, updated_at)
   - Achievement (id, slug UK, title_ru, icon_emoji)
   - UserAchievement (id, user_id FK, achievement_id FK, achieved_at)
   - Streak (id, user_id FK, current_streak, longest_streak, last_workout_date, shield_count, updated_at)
   - Seed 10 achievements: first_workout, ten_workouts, hundred_workouts, first_pr, streak_7, streak_30...
4. src/services/push.service.ts:
   - sendToUser(userId, {title, body, data}): –¥–æ—Å—Ç–∞—Ç—å push_tokens –ø–æ userId, –æ—Ç–ø—Ä–∞–≤–∏—Ç—å APNs –∏–ª–∏ FCM
   - APNs —á–µ—Ä–µ–∑ node-apn: provider + token
   - FCM —á–µ—Ä–µ–∑ firebase-admin: messaging().send()
5. src/services/streak.service.ts:
   - updateStreak(userId, workoutDate): –æ–±–Ω–æ–≤–∏—Ç—å current_streak, longest_streak, last_workout_date
   - checkStreakBreak(): –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–π cron ‚Äî –µ—Å–ª–∏ last_workout_date < yesterday ‚Üí current_streak = 0 (–µ—Å–ª–∏ –Ω–µ—Ç shield)
   - useShield(userId): shield_count-- –µ—Å–ª–∏ > 0
6. src/workers/notification.worker.ts (BullMQ):
   - Queue: 'notifications'
   - Worker –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç jobs: pr_achieved, streak_reminder, achievement_unlocked
7. –í WorkoutService.approveDraft() –¥–æ–±–∞–≤–∏—Ç—å:
   - streakService.updateStreak(userId, workout.workout_date)
   - –î–æ–±–∞–≤–∏—Ç—å job –≤ queue: notificationQueue.add('pr_achieved', {userId, prData}) –µ—Å–ª–∏ PR –Ω–∞–π–¥–µ–Ω
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å achievements: –µ—Å–ª–∏ first_workout ‚Üí unlock + notificationQueue.add('achievement_unlocked')
8. Cron job (BullMQ repeatable): –∫–∞–∂–¥—ã–π —á–∞—Å ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —É –∫–æ—Ç–æ—Ä—ã—Ö < 2 —á–∞—Å–æ–≤ –¥–æ –ø–æ–ª—É–Ω–æ—á–∏ –ø–æ TZ –∏ –Ω–µ—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ —Å–µ–≥–æ–¥–Ω—è ‚Üí –¥–æ–±–∞–≤–∏—Ç—å job 'streak_reminder'
9. POST /api/v1/users/me/push-token ‚Äî —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–∫–µ–Ω (upsert –ø–æ token)
   DELETE /api/v1/users/me/push-token/:token ‚Äî —É–¥–∞–ª–∏—Ç—å

–ó–∞–¥–∞—á–∏ –≤ apps/mobile:
10. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å: expo-notifications
11. hooks/usePushNotifications.ts:
    - registerForPushNotifications(): –∑–∞–ø—Ä–æ—Å–∏—Ç—å Permission ‚Üí getExpoPushToken() ‚Üí POST /users/me/push-token
    - –í—ã–∑–≤–∞—Ç—å –≤ app/_layout.tsx –ø–æ—Å–ª–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
12. app/(tabs)/profile.tsx: –ø–æ–∫–∞–∑–∞—Ç—å currentStreak, longestStreak, —Å–ø–∏—Å–æ–∫ achievements —Å –∏–∫–æ–Ω–∫–∞–º–∏

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
- BullMQ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ—Ç –∂–µ Redis —á—Ç–æ –∏ —Å–µ—Å—Å–∏–∏
- Cron jobs: —Ç–æ–ª—å–∫–æ 1 –∏–Ω—Å—Ç–∞–Ω—Å –≤–æ—Ä–∫–µ—Ä–∞ (distributed lock —á–µ—Ä–µ–∑ Redis)
- –ù–µ –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å push –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫–ª—é—á–∏–ª —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

Acceptance criteria:
- [ ] pnpm lint && pnpm test ‚Äî –∑–µ–ª—ë–Ω—ã–µ
- [ ] –ü–æ—Å–ª–µ approve —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ ‚Üí streak –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ –ë–î
- [ ] PR ‚Üí push —á–µ—Ä–µ–∑ < 10 —Å–µ–∫—É–Ω–¥ –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
- [ ] Shield: –µ—Å–ª–∏ —Ç–µ–∫—É—â–∏–π streak > 0 –∏ —ç—Ç–æ –ø–µ—Ä–≤—ã–π –ø—Ä–æ–ø—É—Å–∫ –∑–∞ –º–µ—Å—è—Ü ‚Üí shield –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- [ ] –≠–∫—Ä–∞–Ω –ø—Ä–æ—Ñ–∏–ª—è: streak –∏ achievements –≤–∏–¥–Ω—ã
```

---

## –§–∞–∑–∞ 3: AI-—Ç—Ä–µ–Ω–µ—Ä (KF-002, KF-004)

> –ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω–Ω–æ—Å—Ç—å: –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –∏ —Å–æ–ø–µ—Ä–Ω–∏—á–µ—Å—Ç–≤–æ —Å –¥—Ä—É–∑—å—è–º–∏.

### –û–±–∑–æ—Ä –§–∞–∑—ã 3

#### üßë‚Äçüíº –î–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç**: –î–æ–±–∞–≤–ª—è–µ–º ¬´—É–º–Ω–æ–≥–æ —Ç—Ä–µ–Ω–µ—Ä–∞¬ª ‚Äî AI –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏—Å—Ç–æ—Ä–∏—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫, –¥–∞–Ω–Ω—ã–µ –æ —Å–Ω–µ –∏ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º—É. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–ª–æ—Ö–æ —Å–ø–∞–ª, —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ª–µ–≥—á–µ. –ï—Å–ª–∏ –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–µ–¥–µ–ª—å —Å—Ç–∞–≥–Ω–∏—Ä—É–µ—Ç ‚Äî AI –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–µ–Ω—è–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º—É.

**–ü–æ—á–µ–º—É —ç—Ç–æ –≤—ã–¥–µ–ª—è–µ—Ç –Ω–∞—Å**: –ö–æ–Ω–∫—É—Ä–µ–Ω—Ç—ã –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏. –ú—ã ‚Äî –¥—É–º–∞–µ–º –∑–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**–ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è**: AI-—Ç—Ä–µ–Ω–µ—Ä ‚Äî Premium —Ñ—É–Ω–∫—Ü–∏—è (~$9.99/–º–µ—Å).

**–ú–µ—Ç—Ä–∏–∫–∞ —É—Å–ø–µ—Ö–∞**: 8%+ –∫–æ–Ω–≤–µ—Ä—Å–∏—è Free ‚Üí Premium.

---

#### ü§ñ –ü—Ä–æ–º–ø—Ç –¥–ª—è AI-–∞–≥–µ–Ω—Ç–∞ (3.1 AI Trainer Service)

```prompt
–†–µ–∞–ª–∏–∑—É–π AI Trainer Service –¥–ª—è FitApp (–§–∞–∑–∞ 3).

–ö–æ–Ω—Ç–µ–∫—Å—Ç:
- –ú–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: /Users/elizavetagolubenko/Projects/fit-tel-bot
- –ë–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è: FIT_APP_BUSINESS_REQUIREMENTS.md (KF-002)
- System design: docs/architecture/design/FIT_APP_SYSTEM_DESIGN.md (—Ä–∞–∑–¥–µ–ª 2, 5)
- –§–∞–∑—ã 0‚Äì2 –≤—ã–ø–æ–ª–Ω–µ–Ω—ã; analytics.service.ts —Ä–∞–±–æ—Ç–∞–µ—Ç

–ó–∞–¥–∞—á–∏ –≤ apps/api:
1. src/services/ai-trainer.service.ts:
   - generateWeeklyPlan(userId): –∞–Ω–∞–ª–∏–∑ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 30 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ ‚Üí DeepSeek V3 ‚Üí —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–ª–∞–Ω –Ω–∞ –Ω–µ–¥–µ–ª—é
   - adaptPlan(userId, signals: {sleepHours?, rpe?, missedWorkouts?}): —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–≥—Ä—É–∑–∫—É
   - detectOvertraining(userId): –µ—Å–ª–∏ –æ–±—ä—ë–º –≤—ã—Ä–æ—Å > 10% –∑–∞ –Ω–µ–¥–µ–ª—é –∏–ª–∏ –Ω–µ—Ç –¥–Ω–µ–π –æ—Ç–¥—ã—Ö–∞ ‚Üí return warning
   - detectMuscleImbalance(userId): –∏–∑ analytics.getMuscleGroupVolume ‚Üí —Å—Ä–∞–≤–Ω–∏—Ç—å push/pull ratio
   - generateWeeklyReport(userId): markdown –æ—Ç—á—ë—Ç –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
2. src/routes/ai-trainer.routes.ts:
   GET /ai-trainer/recommendations ‚Äî —Ç–µ–∫—É—â–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
   GET /ai-trainer/weekly-report ‚Äî –æ—Ç—á—ë—Ç –∑–∞ –ø—Ä–æ—à–µ–¥—à—É—é –Ω–µ–¥–µ–ª—é
   POST /ai-trainer/adapt-plan {signals} ‚Äî —è–≤–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è
3. BullMQ repeatable job: –∫–∞–∂–¥–æ–µ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ 20:00 –ø–æ TZ ‚Üí generateWeeklyReport ‚Üí push —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
4. –ï—Å–ª–∏ detectOvertraining ‚Üí –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –≤ recommendations
5. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Apple Health / Google Fit (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –µ—Å–ª–∏ –µ—Å—Ç—å OAuth):
   - –ü—Ä–∏–Ω–∏–º–∞—Ç—å sleepHours —á–µ—Ä–µ–∑ POST /users/me/health-data {sleepHours, heartRateVariability}

–ó–∞–¥–∞—á–∏ –≤ apps/mobile:
6. app/ai-trainer/index.tsx: —ç–∫—Ä–∞–Ω —Å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º–∏, –∫–∞—Ä—Ç–æ—á–∫–∏ —Å –∏–∫–æ–Ω–∫–∞–º–∏ –∏ —Ç–µ–∫—Å—Ç–æ–º
7. app/ai-trainer/weekly-report.tsx: –æ—Ç—á—ë—Ç –≤ Markdown (react-native-markdown-display)
8. –ü—É—à –≤ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ ‚Üí deep link ‚Üí –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç weekly-report

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
- DeepSeek V3 –ø—Ä–æ–º–ø—Ç –≤–∫–ª—é—á–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –∫–∞–∫ JSON (–Ω–µ –≤–µ—Å—å –º–∞—Å—Å–∏–≤)
- Temperature: 0.3 (–±–ª–∏–∂–µ –∫ deterministic –¥–ª—è –ø–ª–∞–Ω–æ–≤)
- –í—Å–µ –≤—ã–∑–æ–≤—ã AI –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å —Å latency —á–µ—Ä–µ–∑ pino

Acceptance criteria:
- [ ] GET /ai-trainer/recommendations –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç ‚â• 1 —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é
- [ ] –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ–± overtraining –ø—Ä–∏ —Ä–æ—Å—Ç–µ –æ–±—ä—ë–º–∞ > 10% –∑–∞ –Ω–µ–¥–µ–ª—é
- [ ] Weekly report –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∏ –ø—Ä–∏—Ö–æ–¥–∏—Ç –∫–∞–∫ push –≤ –≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ
```

---

## –§–∞–∑–∞ 4: –ê–Ω–∞–ª–∏–∑ —Ç–µ—Ö–Ω–∏–∫–∏ (KF-005)

> [!NOTE]
> –¢–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ App MVP+ (–§–∞–∑—ã 0‚Äì2). –ö—Ä–∞–π–Ω–µ —Å–ª–æ–∂–Ω–∞—è —Ñ–∏—á–∞.

#### üßë‚Äçüíº –î–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç**: –ö–∞–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Ç–µ—Ö–Ω–∏–∫—É —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏. ¬´–ö–æ–ª–µ–Ω–æ —É—Ö–æ–¥–∏—Ç –≤–Ω—É—Ç—Ä—å¬ª ‚Äî –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–¥—Å–∫–∞–∂–µ—Ç –ø—Ä—è–º–æ –≤–æ –≤—Ä–µ–º—è –ø–æ–¥—Ö–æ–¥–∞.

**–°–ª–æ–∂–Ω–æ—Å—Ç—å**: Pose estimation ‚Äî AI –∑–∞–¥–∞—á–∞, —Ä–∞–±–æ—Ç–∞—é—â–∞—è –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ (–±–µ–∑ —Å–µ—Ç–∏). –¢—Ä–µ–±—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Ä–µ—Å—ë—Ä—á–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è.

---

#### ü§ñ –ü—Ä–æ–º–ø—Ç –¥–ª—è AI-–∞–≥–µ–Ω—Ç–∞ (4.1 Pose Estimation MVP)

```prompt
–†–µ–∞–ª–∏–∑—É–π –±–∞–∑–æ–≤—ã–π pose estimation –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Ç–µ—Ö–Ω–∏–∫–∏ –ø—Ä–∏—Å–µ–¥–∞–Ω–∏–π (—à–∞–≥ 4.1 MVP).

–ö–æ–Ω—Ç–µ–∫—Å—Ç:
- apps/mobile (React Native + Expo, –§–∞–∑—ã 0‚Äì2 –≤—ã–ø–æ–ª–Ω–µ–Ω—ã)
- –ë–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è: FIT_APP_BUSINESS_REQUIREMENTS.md (KF-005)
- –¢–û–õ–¨–ö–û –¥–ª—è iOS –≤ –ø–µ—Ä–≤–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ (Apple Vision Framework)

–ó–∞–¥–∞—á–∏:
1. –°–æ–∑–¥–∞—Ç—å –Ω–∞—Ç–∏–≤–Ω—ã–π –º–æ–¥—É–ª—å apps/mobile/modules/PoseDetection/:
   - iOS: PoseDetectionModule.swift –∏—Å–ø–æ–ª—å–∑—É—è VNDetectHumanBodyPoseRequest (Vision Framework)
   - Expo Module API (–Ω–µ —Å—Ç–∞—Ä—ã–π bridge) –¥–ª—è bridge –≤ React Native
2. hooks/usePoseDetection.ts: –æ–±—ë—Ä—Ç–∫–∞ –Ω–∞–¥ –Ω–∞—Ç–∏–≤–Ω—ã–º –º–æ–¥—É–ª–µ–º
3. app/technique-analysis/[exerciseId].tsx:
   - –ö–∞–º–µ—Ä–∞ (expo-camera)
   - Overlay —Å skeleton (react-native-svg –ª–∏–Ω–∏–∏ –º–µ–∂–¥—É landmarks)
   - –ê–Ω–∞–ª–∏–∑: –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —É–≥–æ–ª –∫–æ–ª–µ–Ω–∞ (< 170¬∞ –≤ –Ω–∏–∂–Ω–µ–π —Ç–æ—á–∫–µ –ø—Ä–∏—Å–µ–¥–∞ ‚Üí –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ ¬´–∫–æ–ª–µ–Ω–æ —É—Ö–æ–¥–∏—Ç –≤–Ω—É—Ç—Ä—å¬ª)
4. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å: –ø—Ä–∏—Å–µ–¥–∞–Ω–∏—è, –æ—Ç–∂–∏–º–∞–Ω–∏—è (–¥–ª—è —Å—Ç–∞—Ä—Ç–∞)
5. –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á—ë—Ç: –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –æ—à–∏–±–æ–∫ + preview –∫–∞–¥—Ä–∞

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
- Android: ML Kit Pose Detection (–æ—Ç–¥–µ–ª—å–Ω–∞—è –∑–∞–¥–∞—á–∞ –ø–æ—Å–ª–µ iOS MVP)
- –¢–æ–ª—å–∫–æ on-device, –Ω–∏–∫–∞–∫–∏—Ö API –≤—ã–∑–æ–≤–æ–≤ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

Acceptance criteria:
- [ ] –ö–∞–º–µ—Ä–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç skeleton overlay –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- [ ] –û—à–∏–±–∫–∞ ¬´–∫–æ–ª–µ–Ω–æ –≤–Ω—É—Ç—Ä—å¬ª –¥–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç—Å—è > 80% —Å–ª—É—á–∞–µ–≤
```
